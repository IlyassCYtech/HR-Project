<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      layout:decorate="~{layout/main}">
<head>
    <title th:text="'Profil de ' + ${employe.prenom} + ' ' + ${employe.nom} + ' - RH Élégance'">Profil - RH Élégance</title>
</head>
<body>
    <div layout:fragment="content">
        <!-- Page Header with Avatar -->
        <div class="header">
            <div style="display: flex; align-items: center; gap: 24px;">
                <div class="avatar-lg">
                    <span th:text="${employe.prenom.substring(0,1) + employe.nom.substring(0,1)}">JD</span>
                </div>
                <div style="flex: 1;">
                    <h1 style="margin-bottom: 8px;">
                        <span th:text="${employe.prenom + ' ' + employe.nom}">Jean Dupont</span>
                    </h1>
                    <p class="subtitle">
                        <span th:text="${employe.poste}">Poste</span>
                        <span th:if="${employe.departement != null}">
                            • <span th:text="${employe.departement.nom}">Département</span>
                        </span>
                        • <span th:text="${employe.matricule}">MAT001</span>
                    </p>
                </div>
                <div style="display: flex; gap: 12px;">
                    <a sec:authorize="hasAnyRole('ADMIN', 'RH')"
                       th:href="@{/employes/form/{id}(id=${employe.id})}" 
                       class="btn btn-primary">
                        <i class="fas fa-edit" style="margin-right: 8px;"></i>Modifier
                    </a>
                    <a th:href="@{/employes/list}" class="btn btn-secondary">
                        <i class="fas fa-arrow-left" style="margin-right: 8px;"></i>Retour
                    </a>
                </div>
            </div>
        </div>

        <!-- Statistics Cards -->
        <div class="stats-grid" style="grid-template-columns: repeat(4, 1fr); margin-bottom: 32px;">
            <div class="stat-card">
                <i class="fas fa-building"></i>
                <h4 th:text="${employe.departement != null ? employe.departement.nom : 'N/A'}">N/A</h4>
                <p>Département</p>
            </div>

            <div class="stat-card">
                <i class="fas fa-star"></i>
                <h4 th:text="${employe.grade}">CADRE</h4>
                <p>Grade</p>
            </div>

            <div class="stat-card">
                <i class="fas fa-euro-sign"></i>
                <span sec:authorize="hasAnyRole('ADMIN', 'RH')">
                    <h4 th:text="${#numbers.formatDecimal(employe.salaireBase, 1, 'COMMA', 0, 'POINT')} + ' €'">0 €</h4>
                    <p>Salaire de base</p>
                </span>
                <span sec:authorize="!hasAnyRole('ADMIN', 'RH')">
                    <h4><i class="fas fa-lock" style="color: #999;"></i></h4>
                    <p style="color: #999;">Confidentiel</p>
                </span>
            </div>

            <div class="stat-card">
                <i class="fas fa-calendar"></i>
                <h4 th:text="${employe.dateEmbauche != null ? #temporals.format(employe.dateEmbauche, 'dd/MM/yyyy') : 'N/A'}">N/A</h4>
                <p>Date d'embauche</p>
            </div>
        </div>

        <!-- Two Column Layout -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 24px;">
            <!-- Informations personnelles -->
            <div class="card">
                <div class="card-header">
                    <i class="fas fa-user" style="margin-right: 12px;"></i>Informations personnelles
                </div>
                <div style="padding: 32px;">
                    <div style="margin-bottom: 24px;">
                        <label class="form-label">Email</label>
                        <p style="font-size: 16px; color: #1A1A1A; font-weight: 500;">
                            <a th:if="${employe.email != null && !employe.email.isEmpty()}" 
                               th:href="'mailto:' + ${employe.email}" 
                               th:text="${employe.email}"
                               style="color: #C5A572; text-decoration: none;">email@example.com</a>
                            <span th:if="${employe.email == null || employe.email.isEmpty()}" style="color: #999999;">Non renseigné</span>
                        </p>
                    </div>

                    <div style="margin-bottom: 24px;">
                        <label class="form-label">Téléphone</label>
                        <span sec:authorize="hasAnyRole('ADMIN', 'RH')">
                            <p style="font-size: 16px; color: #1A1A1A; font-weight: 500;">
                                <span th:if="${employe.telephone != null && !employe.telephone.isEmpty()}" th:text="${employe.telephone}">N/A</span>
                                <span th:if="${employe.telephone == null || employe.telephone.isEmpty()}" style="color: #999999;">Non renseigné</span>
                            </p>
                        </span>
                        <span sec:authorize="!hasAnyRole('ADMIN', 'RH')">
                            <p style="font-size: 16px; color: #999999; font-style: italic;">
                                <i class="fas fa-lock" style="margin-right: 8px;"></i>Confidentiel
                            </p>
                        </span>
                    </div>

                    <div style="margin-bottom: 24px;">
                        <label class="form-label">Adresse</label>
                        <p class="info-value">
                            <span th:if="${employe.adresse != null && !employe.adresse.isEmpty()}" th:text="${employe.adresse}">N/A</span>
                            <span th:if="${employe.adresse == null || employe.adresse.isEmpty()}" style="color: #999999;">Non renseignée</span>
                        </p>
                    </div>

                    <div>
                        <label class="info-label">Date de naissance</label>
                        <p class="info-value">
                            <span sec:authorize="hasAnyRole('ADMIN', 'RH')">
                                <span th:if="${employe.dateNaissance != null}" th:text="${#temporals.format(employe.dateNaissance, 'dd/MM/yyyy')}">N/A</span>
                                <span th:if="${employe.dateNaissance == null}" style="color: #999999;">Non renseignée</span>
                            </span>
                            <span sec:authorize="!hasAnyRole('ADMIN', 'RH')" style="color: #999999; font-style: italic;">
                                <i class="fas fa-lock" style="margin-right: 8px;"></i>Confidentiel
                            </span>
                        </p>
                    </div>
                </div>
            </div>

            <!-- Informations professionnelles -->
            <div style="background: #FFFFFF; border: 1px solid #E0E0E0;">
                <div style="padding: 20px 32px; border-bottom: 1px solid #E0E0E0; background: #FAFAFA;">
                    <h2 style="font-family: 'Playfair Display', serif; font-size: 18px; color: #1A1A1A; margin: 0;">
                        <i class="fas fa-briefcase" style="margin-right: 12px; color: #C5A572;"></i>
                        Informations professionnelles
                    </h2>
                </div>
                <div style="padding: 32px;">
                    <div style="margin-bottom: 24px;">
                        <label class="info-label">Date d'embauche</label>
                        <p class="info-value" th:text="${employe.dateEmbauche != null ? #temporals.format(employe.dateEmbauche, 'dd/MM/yyyy') : 'N/A'}">N/A</p>
                    </div>

                    <div style="margin-bottom: 24px;">
                        <label class="info-label">Manager</label>
                        <p class="info-value">
                            <a th:if="${employe.manager != null}" 
                               th:href="@{/employes/show/{id}(id=${employe.manager.id})}"
                               th:text="${employe.manager.prenom + ' ' + employe.manager.nom}"
                               style="color: #C5A572; text-decoration: none;">Manager</a>
                            <span th:if="${employe.manager == null}" style="color: #999999;">Aucun manager</span>
                        </p>
                    </div>

                    <div>
                        <label class="info-label">Statut</label>
                        <p>
                            <span th:if="${employe.statut.name() == 'ACTIF'}" 
                                  style="padding: 6px 16px; background: #F0FFF4; color: #22543D; font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; display: inline-block;">
                                Actif
                            </span>
                            <span th:if="${employe.statut.name() == 'INACTIF'}" 
                                  style="padding: 6px 16px; background: #FFF5F5; color: #742A2A; font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; display: inline-block;">
                                Inactif
                            </span>
                            <span th:if="${employe.statut.name() == 'EN_CONGE'}" 
                                  style="padding: 6px 16px; background: #FFFAF0; color: #7C2D12; font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; display: inline-block;">
                                En congé
                            </span>
                            <span th:if="${employe.statut.name() == 'SUSPENDU'}" 
                                  style="padding: 6px 16px; background: #F7FAFC; color: #2D3748; font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; display: inline-block;">
                                Suspendu
                            </span>
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Actions rapides -->
        <div class="card">
            <div class="card-header">
                <i class="fas fa-lightning-bolt" style="margin-right: 12px;"></i>Actions rapides
            </div>
            <div style="padding: 32px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
                <a th:href="@{/fiches-paie/list(employeId=${employe.id})}" 
                   class="btn btn-outline">
                    <i class="fas fa-file-invoice-dollar" style="margin-right: 8px;"></i>Voir les fiches de paie
                </a>
                <a th:href="@{/conges/list(employeId=${employe.id})}" 
                   class="btn btn-outline">
                    <i class="fas fa-calendar-check" style="margin-right: 8px;"></i>Voir les congés
                </a>
                <a th:href="@{/projets/list(employeId=${employe.id})}" 
                   class="btn btn-outline">
                    <i class="fas fa-project-diagram" style="margin-right: 8px;"></i>Voir les projets
                </a>
            </div>
        </div>
    </div>

    <style layout:fragment="styles">
        .info-label {
            display: block;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #666666;
            margin-bottom: 8px;
            font-weight: 500;
        }
        .info-value {
            font-size: 16px;
            color: #1A1A1A;
            font-weight: 500;
            margin: 0;
        }
    </style>
</body>
</html>
